# configuration management
 Completing practical tasks in the discipline "configuration management"

### Вариант №4
### Задание №1
Разработать эмулятор для языка оболочки ОС. Необходимо сделать работу
эмулятора как можно более похожей на сеанс shell в UNIX-подобной ОС.
Эмулятор должен запускаться из реальной командной строки, а файл с
виртуальной файловой системой не нужно распаковывать у пользователя.
Эмулятор принимает образ виртуальной файловой системы в виде файла формата
tar. Эмулятор должен работать в режиме CLI.
Ключами командной строки задаются:
• Имя пользователя для показа в приглашении к вводу.
• Путь к архиву виртуальной файловой системы.
• Путь к лог-файлу.
Лог-файл имеет формат xml и содержит все действия во время последнего
сеанса работы с эмулятором. Для каждого действия указан пользователь.
Необходимо поддержать в эмуляторе команды ls, cd и exit, а также
следующие команды:
1. rm.
2. tree.
Все функции эмулятора должны быть покрыты тестами, а для каждой из
поддерживаемых команд необходимо написать 3 теста.

### Общее описание

Этот код представляет собой реализацию эмулятора командной оболочки (shell) на языке C++, который работает с виртуальной файловой системой, смонтированной из tar-архива. Пользователь может выполнять стандартные команды оболочки, такие как `ls`, `cd`, `rm`, и `tree`. Все действия пользователя логируются в XML-файл с помощью библиотеки `tinyxml2`. Эмулятор предназначен для работы с файловой системой, извлеченной из tar-архива, и поддерживает простые команды для навигации и управления файлами.

### Описание основных элементов

1. **Namespaces и библиотеки**:
   - `fs = std::filesystem`: используется для работы с файловой системой (перемещение, удаление, и получение информации о файлах).
   - `tinyxml2`: используется для создания XML логов.
   - `libtar`: библиотека для работы с tar-архивами. Она позволяет извлекать файлы из tar-архива.

2. **Основные задачи**:
   - Монтирование виртуальной файловой системы из tar-архива.
   - Обработка стандартных команд оболочки (`ls`, `cd`, `rm`, `tree`, и `exit`).
   - Логирование всех действий пользователя в XML-файл.

### Описание функций

1. **`void logAction(const std::string& username, const std::string& command, const std::string& logPath)`**:
   - **Назначение**: Логирует действия пользователя в XML-файл.
   - **Аргументы**:
     - `username`: Имя пользователя, выполняющего команду.
     - `command`: Команда, которую выполняет пользователь.
     - `logPath`: Путь к XML-файлу для логирования.
   - **Описание**: Функция открывает или создает XML-файл логов. Каждое действие пользователя добавляется как элемент `<action>`, который включает атрибуты `user` (имя пользователя) и `command` (выполненная команда).

2. **`void listDirectory(const std::string& currentPath)`**:
   - **Назначение**: Выводит список файлов и директорий в текущем каталоге.
   - **Аргументы**:
     - `currentPath`: Путь к текущему каталогу.
   - **Описание**: Используя `std::filesystem::directory_iterator`, функция выводит имена всех файлов и директорий в указанном каталоге.

3. **`void changeDirectory(std::string& currentPath, const std::string& newPath)`**:
   - **Назначение**: Меняет текущий каталог на новый.
   - **Аргументы**:
     - `currentPath`: Ссылка на строку с текущим путем, которая будет обновлена на новый путь.
     - `newPath`: Новый путь, на который следует перейти.
   - **Описание**: Функция проверяет, существует ли указанный путь и является ли он директорией. Если да, то текущий путь обновляется, иначе выводится ошибка.

4. **`void removeFileOrDirectory(const std::string& path)`**:
   - **Назначение**: Удаляет файл или директорию по указанному пути.
   - **Аргументы**:
     - `path`: Путь к файлу или директории, которые необходимо удалить.
   - **Описание**: Функция проверяет существование файла или директории и, если они существуют, удаляет их вместе с содержимым. В случае отсутствия файла или директории выводится сообщение об ошибке.

5. **`void printTree(const fs::path& dirPath, const std::string& prefix = "")`**:
   - **Назначение**: Рекурсивно выводит содержимое каталога в виде дерева.
   - **Аргументы**:
     - `dirPath`: Путь к каталогу, который нужно вывести.
     - `prefix`: Строка для создания отступов в выводе, указывающая вложенность файлов.
   - **Описание**: Функция рекурсивно проходит по каталогам и выводит их структуру в виде дерева с отступами, показывающими уровни вложенности.

6. **Основная программа (функция `main`)**:
   - **Назначение**: Управляет основным циклом программы и обрабатывает ввод команд.
   - **Параметры**:
     - `argc`: Количество аргументов командной строки.
     - `argv`: Массив аргументов командной строки (имя пользователя, путь к tar-архиву, путь к XML-файлу логов).
   - **Описание**:
     - Проверяет правильность переданных аргументов.
     - Извлекает содержимое tar-архива во временную директорию.
     - Логирует действия пользователя, такие как запуск эмулятора и выполнение команд.
     - Поддерживает команды:
       - `ls`: Вывод содержимого текущего каталога.
       - `cd`: Переход в другой каталог.
       - `rm`: Удаление файла или директории.
       - `tree`: Вывод структуры каталогов в виде дерева.
       - `exit`: Выход из программы.

### Настройки

- **Аргументы командной строки**:
  1. Имя пользователя.
  2. Путь к tar-архиву, который будет использоваться в качестве файловой системы.
  3. Путь к XML-файлу для логирования действий.

- **Работа с tar-архивами**: 
  - Для работы с tar-архивами используется библиотека `libtar`. Файловая система из архива извлекается во временную директорию.

- **Логирование**:
  - Все действия пользователя логируются в XML-файл через библиотеку `tinyxml2`.
 
### Примеры использования
- **Использовала WSL**
![image](https://github.com/user-attachments/assets/33d0e2d0-bcf2-4ffe-be60-eeeca57b3f69)

